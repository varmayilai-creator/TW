<!-- === BEGIN Onam Celebration HTML === -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>TrailWalkers Onam Celebration - Melbourne</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet" />

<style>
/* Styles unchanged except colour mapping handled via JS */
</style>
</head>
<body>

<!-- ...HEADER & other tabs remain unchanged... -->

<!-- Sadya Items Tab -->
<div id="sadya" class="tab-content">
<section>
<h2>Sadya Items & Owners</h2>
<p>Select a couple for the dish you'd like to contribute. Updates sync live to Google Sheets.</p>

<table class="sadya-table">
<thead>
<tr><th>Dish Name</th><th>Description</th><th>Owner / Contributor</th></tr>
</thead>
<tbody>
<tr><td>Sambar</td><td>A lentil and vegetable stew</td>
<td><select class="owner-select">
<option value="">---</option>
<option value="Anitha n Rajeev">Anitha n Rajeev</option>
<option value="Anna n Shilton">Anna n Shilton</option>
<option value="Anu n Nikhil">Anu n Nikhil</option>
<option value="Deepthi n Jibin">Deepthi n Jibin</option>
<option value="Diana n Sunil">Diana n Sunil</option>
<option value="Deepika n Dinu">Deepika n Dinu</option>
<option value="Josna n Rajeeb">Josna n Rajeeb</option>
<option value="Liji n Manoj">Liji n Manoj</option>
<option value="Manju n Pramode">Manju n Pramode</option>
<option value="Parvathy n Rajesh">Parvathy n Rajesh</option>
<option value="Priya n Sree">Priya n Sree</option>
<option value="Sowmya n Praveen">Sowmya n Praveen</option>
<option value="Susan n Roy">Susan n Roy</option>
</select></td></tr>

<!-- Repeat for every dish exactly as above... -->
</tbody>
</table>
<p id="status-message"></p>
</section>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const appScriptUrl = 'https://script.google.com/macros/s/AKfycbxdw1O5_9cVdyIADuqv3N6Q5bGz8TOlMNT0qeeI8O2DDQ7QsjEgQj1jBEZNeWoFykmh/exec';
    const sheetName = 'OnamSadyaData';
    const statusMessage = document.getElementById('status-message');

    const nameColors = {
        "Anitha n Rajeev": "#FFD1DC",
        "Anna n Shilton": "#B0E0E6",
        "Anu n Nikhil": "#CCEEFF",
        "Deepthi n Jibin": "#D8F8D8",
        "Diana n Sunil": "#FAFAD2",
        "Deepika n Dinu": "#F0E68C",
        "Josna n Rajeeb": "#E6E6FA",
        "Liji n Manoj": "#FFDAB9",
        "Manju n Pramode": "#ADD8E6",
        "Parvathy n Rajesh": "#98FB98",
        "Priya n Sree": "#F5DEB3",
        "Sowmya n Praveen": "#AFEEEE",
        "Susan n Roy": "#DDA0DD"
    };

    const updateRowStyle = (selectElement) => {
        const tr = selectElement.closest('tr');
        const owner = selectElement.value;
        if (owner && nameColors[owner]) {
            tr.style.backgroundColor = nameColors[owner];
        } else {
            const isEven = Array.from(tr.parentNode.children).indexOf(tr) % 2 !== 0;
            tr.style.backgroundColor = isEven ? 'var(--secondary-bg)' : '';
        }
    };

    const fetchSadyaData = () => {
        fetch(`${appScriptUrl}?sheet=${sheetName}`)
            .then(r => r.json())
            .then(data => {
                if (data.status === 'success') {
                    document.querySelectorAll('.sadya-table tbody tr').forEach(row => {
                        const dish = row.cells[0].textContent.trim();
                        const select = row.querySelector('.owner-select');
                        const record = data.data.find(item => item.DishName === dish);
                        if (record) {
                            select.value = record.Owner || '';
                            updateRowStyle(select);
                        }
                    });
                }
            })
            .catch(err => console.error('Fetch error', err));
    };

    const updateSadyaOwner = (dishName, owner, selectElement) => {
        selectElement.disabled = true;
        fetch(appScriptUrl, {
            method: 'POST',
            mode: 'no-cors',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ sheetName, dishName, owner })
        }).finally(() => {
            selectElement.disabled = false;
        });
    };

    document.querySelectorAll('.owner-select').forEach(select => {
        select.addEventListener('change', function() {
            updateRowStyle(this);
            const dish = this.closest('tr').cells[0].textContent.trim();
            updateSadyaOwner(dish, this.value, this);
        });
    });

    fetchSadyaData();
});
</script>
</body>
</html>
<!-- === END Onam Celebration HTML === -->
